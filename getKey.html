<script>
// This is an async function to allow the use of 'await'
async function fetchDataFromSheet() {

    // 1. Your two API keys
    const apiKeyIp = "AIzaSyDJsdU6DV_Ap6LvMZgSybKCFzUYm1KzXnQ";
    const apiKeyUrl = "AIzaSyBR5H6SA8aIcDQqiDgUiL1En1KA0Rxs9so";

      const sheetId = "1n90gNUPPrkhqQ5I_mbbDpdahei5JxCrQHXgMvaaRV-4";


    // An array of your keys to try
    const keysToTry = [apiKeyIp, apiKeyUrl];

    let sheetData = null;
    let successfulKey = null;

    // 2. Loop through each key in the array
    for (const key of keysToTry) {
        // This is a placeholder URL for a Google Sheet API endpoint.
        // You would replace this with the actual URL for your Google Sheet.
        const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/Presentations?key=${key}`;

        try {
            console.log(`Trying API key: ${key.substring(0, 5)}...`);
            
            // 3. Make the web request
            const response = await fetch(url);

            // Check if the response was successful (status code 200-299)
            if (!response.ok) {
                // If not successful, throw an error to be caught by the 'catch' block
                throw new Error(`HTTP error! Status: ${response.status}`);
            }

            // If successful, parse the JSON data
            sheetData = await response.json();
            successfulKey = key;
            
            console.log("Success! Connection made.");
            
            // 4. Exit the loop since we found a working key
            break; 

        } catch (error) {
            console.log(`Failed to connect with key: ${key.substring(0, 5)}... Error: ${error.message}`);
            // The loop will automatically continue to the next key
        }
    }

    // 5. Final check after the loop has finished
    if (sheetData) {
        console.log("\nSuccessfully retrieved data from the Google Sheet:");
        console.log(sheetData);
        console.log(`The successful API key was: ${successfulKey}`);
    } else {
        console.log("\nCould not connect to the Google Sheet with any of the provided API keys.");
    }
}

// Run the function
fetchDataFromSheet();
</script>